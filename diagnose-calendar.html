<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>诊断日历问题</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        function diagnoseCalendar() {
            console.log('=== 开始诊断日历问题 ===');
            
            // 检查DOM元素
            const calendarGrid = document.getElementById('calendar-grid');
            const currentMonth = document.getElementById('current-month');
            const todayTasks = document.getElementById('today-tasks');
            
            console.log('calendarGrid元素:', calendarGrid);
            console.log('currentMonth元素:', currentMonth);
            console.log('todayTasks元素:', todayTasks);
            
            if (!calendarGrid) {
                console.error('错误: 找不到calendar-grid元素');
                return;
            }
            
            if (!currentMonth) {
                console.error('错误: 找不到current-month元素');
                return;
            }
            
            // 模拟renderCalendar函数
            console.log('开始模拟renderCalendar函数...');
            
            const currentDate = new Date();
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            console.log('当前日期:', currentDate);
            console.log('年份:', year, '月份:', month);
            
            // 更新月份显示
            const options = { year: 'numeric', month: 'long' };
            currentMonth.textContent = currentDate.toLocaleDateString('zh-CN', options);
            console.log('月份标题已更新:', currentMonth.textContent);
            
            // 清空日历网格
            calendarGrid.innerHTML = '';
            console.log('日历网格已清空');
            
            // 获取当月信息
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const firstDayIndex = firstDay.getDay();
            const daysInMonth = lastDay.getDate();
            
            console.log('当月天数:', daysInMonth, '第一天星期:', firstDayIndex);
            
            // 渲染当月天数
            for (let i = 1; i <= daysInMonth; i++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'p-2 border border-gray-100 text-center';
                dayElement.textContent = i;
                calendarGrid.appendChild(dayElement);
            }
            
            console.log('日历渲染完成，共渲染了', daysInMonth, '天');
            console.log('=== 诊断完成 ===');
        }
        
        // 页面加载完成后执行诊断
        document.addEventListener('DOMContentLoaded', function() {
            console.log('页面加载完成，开始诊断...');
            setTimeout(diagnoseCalendar, 1000); // 给页面一点时间加载
        });
    </script>
</head>
<body class="bg-gray-100 p-8">
    <div class="bg-white rounded-xl p-6 max-w-4xl mx-auto">
        <h1 class="text-2xl font-bold mb-6">诊断日历视图问题</h1>
        
        <div class="mb-6">
            <button onclick="diagnoseCalendar()" class="px-4 py-2 bg-blue-500 text-white rounded">
                运行诊断
            </button>
        </div>
        
        <!-- 模拟日历结构 -->
        <div class="bg-white rounded-xl shadow-sm overflow-hidden mb-6">
            <div class="p-4 border-b border-gray-100 flex justify-between items-center">
                <button class="p-2 rounded-full hover:bg-gray-100">
                    <i class="fa fa-chevron-left text-gray-600"></i>
                </button>
                <h3 id="current-month" class="font-medium text-lg"></h3>
                <button class="p-2 rounded-full hover:bg-gray-100">
                    <i class="fa fa-chevron-right text-gray-600"></i>
                </button>
            </div>
            
            <div class="p-4">
                <!-- 星期标题 -->
                <div class="grid grid-cols-7 mb-2">
                    <div class="text-center text-sm font-medium text-gray-500">日</div>
                    <div class="text-center text-sm font-medium text-gray-500">一</div>
                    <div class="text-center text-sm font-medium text-gray-500">二</div>
                    <div class="text-center text-sm font-medium text-gray-500">三</div>
                    <div class="text-center text-sm font-medium text-gray-500">四</div>
                    <div class="text-center text-sm font-medium text-gray-500">五</div>
                    <div class="text-center text-sm font-medium text-gray-500">六</div>
                </div>
                
                <!-- 日历格子 -->
                <div id="calendar-grid" class="grid grid-cols-7 gap-1">
                    <!-- 日历格子将通过JavaScript动态添加 -->
                </div>
            </div>
            
            <div class="p-4 border-t border-gray-100">
                <h4 class="font-medium mb-2">今日任务</h4>
                <div id="today-tasks">
                    <!-- 今日任务将通过JavaScript动态添加 -->
                </div>
            </div>
        </div>
        
        <div class="p-4 bg-gray-100 rounded">
            <h3 class="font-bold mb-2">诊断说明：</h3>
            <p>请按F12打开开发者工具查看控制台输出</p>
            <p>诊断将检查：</p>
            <ul class="list-disc list-inside mt-2">
                <li>DOM元素是否正确获取</li>
                <li>日期计算是否正确</li>
                <li>日历网格渲染是否正常</li>
            </ul>
        </div>
    </div>
</body>
</html>